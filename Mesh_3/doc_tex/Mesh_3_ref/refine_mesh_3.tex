% +------------------------------------------------------------------------+
% | Reference manual page: refine_mesh_3.tex
% +------------------------------------------------------------------------+
% | 13.05.2008   Laurent Rineau
% | Package: Mesh_3
% |
\RCSdef{\RCSmakemeshRev}{$Id$}
\RCSdefDate{\RCSmakemeshDate}{$Date$}
% |
\ccRefPageBegin
%%RefPage: end of header, begin of main body
% +------------------------------------------------------------------------+


\begin{ccRefFunction}{refine_mesh_3}  %% add template arg's if necessary

%% \ccHtmlCrossLink{}     %% add further rules for cross referencing links
%% \ccHtmlIndexC[function]{} %% add further index entries

\ccDefinition

The function \ccRefName\ is a 3D
 mesh generator. It produces simplicial meshes which discretize
 3D domains.

The mesh generation algorithm is a Delaunay refinement process
followed by an optimization phase. 
The  criteria driving the Delaunay refinement
process may be tuned to achieve the user needs with respect to
the size of mesh elements, the accuracy of boundaries approximation,
etc.

The optimization phase is a succession of optimization processes,
including possibly a Lloyd smoothing, an odt-smoothing,
a perturber and an exuder.
 Each optimization process
can be activated or not,
 according to the user requirements
and available time. 
By default, only the perturber and  the exuder are activated.
Note that the benefits of the exuder will be lost if the mesh
is further refined  afterward.
 



\ccGlobalFunction{
  template <class C3T3,
  class MeshDomain_3,
  class MeshCriteria>
  void refine_mesh_3(C3T3& c3t3,
                     MeshDomain_3 mesh_domain,
                     MeshCriteria mesh_criteria,
                     Lloyd lloyd = parameters::no_lloyd(),
                     Odt odt = parameters::no_odt(),
                     Perturb perturb = parameters::perturb(),
                     Exude exude = parameters::exude()); }{}





\begin{ccAdvanced}
The function template \ccRefName{} may be used to refine a previously
computed mesh, e.g.:

\ccc{C3T3 c3t3 = CGAL::make_mesh_3<C3T3>(domain,criteria);}\\
\ccc{CGAL::refine_mesh_3(c3t3, domain, new_criteria);}

Please note that we guarantee the result if and only if the domain does
not change from one refinement to the next one.
\end{ccAdvanced}


\ccParameters

Parameter \ccc{C3T3} is required to be a model of
the concept 
\ccc{MeshComplex_3InTriangulation_3}.
The argument \ccc{c3t3} is passed by
reference as this object is modified by the refinement process. As the
refinement process only adds points to the triangulation, all 
vertices of the triangulation of \ccc{c3t3} remain in the
mesh during the refinement process. Object \ccc{c3t3} can be used to insert
specific points in the domain to ensure that they will be contained in the
final triangulation.

The type \ccc{C3T3} is in particular required to provide a nested type
\ccc{C3T3::Triangulation} for the 3D triangulation
embedding the mesh. The vertex and cell base classes of the
triangulation \ccc{C3T3::Triangulation} are required to be models of the
concepts \ccc{MeshVertexBase_3} and \ccc{MeshCellBase_3}
respectively.

Template parameter \ccc{MeshDomain_3} is required to be a model of
the concept  \ccc{MeshDomain_3} or of the refined concept
\ccc{MeshDomainWithFeatures_3} if $0$ and $1$-dimensional features
of the input complex have to be accurately represented in the mesh.
The argument \ccc{domain}
 is the sole link through which the domain
to be discretized is known  by the mesh generation algorithm. 



% The compatibility requirements between the template parameters
% \ccc{C3T3} and \ccc{MeshDomain} are as follows:
% the nested types \ccc{MeshDomain::Subdomain_index}
% and \ccc{MeshDomain::Index} 
% have to be convertible respectively
% to the nested type \ccc{C3T3::Triangulation::Cell::Index}
% and \ccc{C3T3::Triangulation::Vertex::Index}.

The template parameter \ccc{MeshCriteria} has to be a model of the concept
\ccc{MeshCriteria_3}, or a model of  the refined concept \ccc{MeshCriteriaWithFeatures_3} if the domain has exposed features.
The argument  \ccc{criteria} of 
type \ccc{MeshCriteria}  specifies the
size and shape requirements for  mesh tetrahedra
and  surface facets. These criteria
form the rules which drive the refinement process. All mesh elements
satisfy those criteria at the end of the refinement process.
In addition, if the domain has  features, the argument
\ccc{criteria} provides a sizing field to guide the discretization
of $1$-dimensional exposed features.
 
The four additional parameters are optimization parameters.
They control which optimization processes are performed
and allow the user to tune the parameters of the optimization processes.
We do not describe  the types of optimization parameters  as they are
internal types. The package defines two global
functions for each optimization parameter
 to generate appropriate value of this parameter.

\begin{itemize}
\item \ccc{parameters::lloyd()} and \ccc{parameters::no_lloyd()} are designed to
  trigger or not a call to \ccc{lloyd_optimize_mesh_3} function and to set the
  parameters of this optimizer. If one parameter is not set, the default value of
  \ccc{lloyd_optimize_mesh_3} is used for this parameter.
\item \ccc{parameters::odt()} and \ccc{parameters::no_odt()} are designed to
  trigger or not a call to \ccc{odt_optimize_mesh_3} function and 
to set the  parameters of this optimizer
 If one parameter is not set, the default value of
  \ccc{odt_optimize_mesh_3} is used for this parameter.
\item \ccc{parameters::perturb()} and \ccc{parameters::no_perturb()} are designed  to
  trigger or not a call to \ccc{perturb_mesh_3} function and 
to set the  parameters of this optimizer. If one parameter is not set, the default value of
  \ccc{perturb_mesh_3} is used for this parameter, except for the time bound which is set to be
  equal to the refinement CPU time.
\item \ccc{parameters::exude()} and \ccc{parameters::no_exude()} are designed to
  trigger or not a call to \ccc{exude_mesh_3} function and  to override to set the
  parameters of this optimizer. If one parameter is not set, the default value of
  \ccc{exude_mesh_3} is used for this parameter, except for the time bound which is set to be
  equal to the refinement CPU time.
\end{itemize}


The optimization parameters can be passed in random order. If one parameter
is not passed, its default value is used. The default values are
\ccc{no_lloyd()}, \ccc{no_odt()}, \ccc{perturb()} and \ccc{exude()}.
Note that whatever may be the optimization processes activated,
they are always launched in the order that is a suborder 
of the following (see user manual for further details):
\ccc{lloyd}, \ccc{odt}, \ccc{perturb}, \ccc{exude}.

Beware that optimization of the mesh is obtained
 by perturbing mesh vertices and modifying the mesh connectivity
 and that this  has an impact
on the strict compliance to the refinement criteria. 
Though a strict compliance to mesh criteria
is granted at the end of the Delaunay refinement, this may  no longer be true after
some optimization processes. Also beware that the default behavior does involve some
optimization processes.


\ccSeeAlso

\ccRefIdfierPage{CGAL::make_mesh_3} \\
\ccRefIdfierPage{CGAL::exude_mesh_3} \\
\ccRefIdfierPage{CGAL::perturb_mesh_3} \\
\ccRefIdfierPage{CGAL::lloyd_optimize_mesh_3} \\
\ccRefIdfierPage{CGAL::odt_optimize_mesh_3} \\
\ccRefIdfierPage{CGAL::parameters::exude} \\
\ccRefIdfierPage{CGAL::parameters::no_exude} \\
\ccRefIdfierPage{CGAL::parameters::perturb} \\
\ccRefIdfierPage{CGAL::parameters::no_perturb} \\
\ccRefIdfierPage{CGAL::parameters::lloyd} \\
\ccRefIdfierPage{CGAL::parameters::no_lloyd} \\
\ccRefIdfierPage{CGAL::parameters::odt} \\
\ccRefIdfierPage{CGAL::parameters::no_odt} \\

\end{ccRefFunction}

% +------------------------------------------------------------------------+
%%RefPage: end of main body, begin of footer
\ccRefPageEnd
% EOF
% +------------------------------------------------------------------------+


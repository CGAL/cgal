namespace CGAL {
/*!

\mainpage User Manual
\anchor Chapter_CT_3
\anchor userchapterct3

\cgalAutoToc
\author Laurent Rineau and Jane Tournois

\image html vase_cdt.png
\image latex vase_cdt.png
<BR>

\section CT_3_CCDT_3 Conforming Delaunay Triangulations in 3D

3D triangulations are a way to partition space, which is useful in many applications.
Sometimes, we want specific faces to appear in the output, for example, to preserve sharp features.
When a triangulation exactly respects these constraints, it is called a _constrained_ triangulation.
In some cases, it is possible to honor the geometry of the constraints but not their combinatorics;
additional points must be insertedâ€”this is called a _conforming_ triangulation.

This package implements an algorithm that constructs conforming triangulations of
3D polygonal constraints. In particular, it requires that these piecewise linear constraints
are part of a _Piecewise Linear Complex_&nbsp;(PLC). The type of produced triangulations is
`Triangulation_3`, described in the chapter \ref PkgTriangulation3.

The problem is described by Cohen-Steiner et al. \cgalCite{cgal:cohen2002conforming},
and by Si \cgalCite{cgal:si2008cdt3}.

\section CT_3_definitions Definitions

In this section, we define the main concepts that have to be understood to use this package.

\subsection CT_3_PLC Piecewise Linear Complex

A _Piecewise Linear Complex_ (PLC) is the 3-dimensional generalization of a
planar straight-line graph. It is a finite set of vertices, edges, and polygons (faces)
that satisfies the following properties:

- The vertices and edges in the PLC form a simplicial complex: two edges may intersect
  only at a common vertex.
- For each polygon in the PLC, its boundary is a union of edges in the PLC.
- If two polygons in the PLC intersect, their intersection is a union of edges and vertices
  in the PLC. In particular, the interiors of two polygons cannot intersect.

The polygons can be non-convex, have holes, and arbitrarily many boundary segments.

\cgalFigureAnchor{CT_3_plc_fig}
<center>
<img src="plc.png" style="max-width:60%;"/>
</center>
\cgalFigureCaptionBegin{CT_3_plc_fig}
A Piecewise Linear Complex, made of planar faces connected by edges and vertices.
\cgalFigureCaptionEnd


\subsection CT_3_CDT Conforming Constrained Delaunay Triangulation

The goal of the algorithms developed in this package is to compute a constrained Delaunay
mesh containing a given set of polygonal constraints in 3D as sub-complex.

A triangulation is a _Delaunay triangulation_ if the circumscribing sphere of any simplex
of the triangulation contains no vertex in its interior (see package \ref PkgTriangulation3
for more details on Delaunay triangulations).

A _constrained Delaunay triangulation_ of a PLC is a constrained triangulation which is as much
Delaunay as possible, given that some facets are marked as _constrained_. More precisely, a
triangulation is _constrained Delaunay_ if for any simplex \f$s\f$ of the triangulation,
the interior of its circumscribing sphere contains no vertex of the triangulation that is
_visible_ from any point of the interior of the simplex \f$s\f$. Two points are _visible_
if the open line segment joining them does not intersect any polygon of the PLC, with the exception
of polygons that are coplanar with the segment.

In 3D, constrained triangulations do not always exist. It can be shown using the
example of the Sch&ouml;nhardt polyhedra \cgalCite{schonhardt1928zerlegung},
\cgalCite{b-ip-48a}, that requires the addition of
Steiner vertices to be tetrahedralizable (see \cgalFigureRef{CT_3_schonhardt_fig}).

\cgalFigureAnchor{CT_3_schonhardt_fig}
<center>
<img src="schonhardt.png" style="max-width:40%;"/>
</center>
\cgalFigureCaptionBegin{CT_3_schonhardt_fig}
A Sch&ouml;nhardt polyhedron.
\cgalFigureCaptionEnd


Shewchuk \cgalCite{cgal:shewchuk1998condition} showed that for any PLC,
there exists another PLC that is a refined version of the original one,
and admits a constrained Delaunay triangulation.
The refined PLC is obtained by adding Steiner vertices on the input edges and facets,
and the constrained triangulation built on this PLC is called
a _conforming constrained Delaunay triangulation_.

The algorithm implemented in this package is based on the work of
Hang Si \cgalCite{si2005meshing}, \cgalCite{si2015tetgen}.
Steiner vertices are added on input edges and input facets
of the PLC to make it tetrahedralizable.

\cgalFigureRef{CT_3_plc2cdt_fig} shows an example of a conforming constrained
Delaunay triangulation constructed from a PLC.

\cgalFigureAnchor{CT_3_plc2cdt_fig}
<center>
<img src="plc_to_cdt.png" style="max-width:90%;"/>
</center>
\cgalFigureCaptionBegin{CT_3_plc2cdt_fig}
Left: PLC (360 vertices);
Middle: CCDT (2452 vertices);
Right: the same CCDT seen with cutplane.
\cgalFigureCaptionEnd


\section CT_3_api API

\subsection CT_3_api_classes Classes

This package provides one main class `Conforming_constrained_Delaunay_triangulation_3`
that represents a 3D conforming constrained Delaunay triangulation.
The class is templated by the geometric traits class and the underlying triangulation class.
The other classes that are provided are secondary classes that define the
vertex and cell types and metadata that constitute the triangulation.

\subsection CT_3_api_functions Functions

Some helper constructor functions, like `make_conforming_constrained_Delaunay_triangulation_3()`,
are provided to create a `Conforming_constrained_Delaunay_triangulation_3` object.

\section CT_3_examples Examples

\subsection CT_3_example_ccdt Build a Conforming Constrained Delaunay Triangulation

The following example demonstrates how to use the helper constructor function
`make_conforming_constrained_Delaunay_triangulation_3()` to create a
conforming constrained Delaunay triangulation from a given PLC.

\cgalExample{Constrained_triangulation_3/conforming_constrained_Delaunay_triangulation_3.cpp }


\subsection CT_3_example_ccdt_soup Build a Conforming Constrained Delaunay Triangulation from a Polygon Soup

It is also possible to create a conforming constrained Delaunay triangulation
from a polygon soup, i.e., a set of polygons for which the connectivity is not known a priori.
This example demonstrates how to build such a triangulation.

\cgalExample{Constrained_triangulation_3/conforming_constrained_Delaunay_triangulation_3_from_soup.cpp }


\subsection CT_3_example_ccdt_fpmap Build a Conforming Constrained Delaunay Triangulation with Known Face Patches

When the user knows a priori the set of patch ids that he wants to attach to faces, this information
can be used and kept valid through the construction of the conforming constrained
Delaunay triangulation.

The following example demonstrates how to detect surface patches separated by sharp edges
and use this surface segmentation in the tetrahedrization process.

When this parameter is used, the 3D triangulation constrained faces indices (available with
\link Conforming_constrained_Delaunay_triangulation_cell_data_3::face_constraint_index() `face_constraint_index()`\endlink
in `Conforming_constrained_Delaunay_triangulation_cell_data_3`)
are set to the corresponding patch ids from this map.
When it is not used, the face indices are set to different indices for each input facet.

\cgalExample{Constrained_triangulation_3/conforming_constrained_Delaunay_triangulation_3_fpmap.cpp}

\cgalFigureRef{ccdt_fpmap} shows the input and output of this triangulation construction example.

\cgalFigureBegin{ccdt_fpmap, ccdt_fpmap.png}
Left: Input PLC;
Middle-left: The corresponding conforming constrained Delaunay triangulation with one patch per input face;
Middle-Right: Input PLC segmented according to sharp edges;
Right: The corresponding conforming constrained Delaunay triangulation using the segmentation.
\cgalFigureEnd
<!-- #camera 5.67784 5.7193 -5.46546 0.830007 -0.459002 0.09482 -0.302349 -->


\subsection CT_3_examples_preprocessing Preprocessing the Input Mesh for Conforming Constrained Delaunay Triangulation

The input mesh must be a valid triangulated surface mesh, i.e., it must not have self-intersections.
Numerous preprocessing functions are available in the \ref PkgPolygonMeshProcessing package.

\subsubsection CT_3_example_ccdt_autorefinement Autorefinement of the Input Mesh

The following examples shows how autorefinement can be used to preprocess the input mesh,
when it is self-intersecting.

\cgalExample{Constrained_triangulation_3/ccdt_3_after_autorefinement.cpp }


\subsubsection CT_3_example_self_intersecting_non_triangles Non-Triangulated Self-Intersecting Input Mesh

The following example shows how to build a conforming constrained Delaunay triangulation from
an input mesh that is not triangulated, and (possibly) self-intersecting.

The function `CGAL::Polygon_mesh_processing::does_self_intersect()` is used to check for self-intersections,
but this function can be used only on triangulated meshes. It is therefore necessary to triangulate
the input mesh before checking for self-intersections, using the function
`CGAL::Polygon_mesh_processing::triangulate_faces()`.

The triangulated version of the mesh is then kept in case of self-intersections,
to use the `CGAL::Polygon_mesh_processing::autorefine()` function to remove the self-intersections.

\cgalExample{Constrained_triangulation_3/ccdt_3_preprocessing.cpp }


\subsection CT_3_example_remesh Remeshing a Conforming Constrained Delaunay Triangulation

Once the triangulation is built, it is possible to remesh it using the
`CGAL::tetrahedral_isotropic_remeshing()` function from the \ref PkgTetrahedralRemeshing package
to improve the quality of the mesh or adapt it to a given sizing field.

The following example shows how to remesh a conforming constrained Delaunay triangulation.

\cgalExample{Constrained_triangulation_3/remesh_constrained_Delaunay_triangulation_3.cpp }


\section CT_3_design Implementation History

The first version of this package was implemented by Laurent Rineau, and published in 2025 in CGAL 6.1. It is based on the theoretical foundation provided by Hang Si's work on meshing algorithms
\cgalCite{si2005meshing}, \cgalCite{si2015tetgen}.

*/
} /* namespace CGAL */

% +------------------------------------------------------------------------+
% | Reference manual page: Apollonius_graph_hierarchy_2.tex
% +------------------------------------------------------------------------+
% | 12.04.2000   Author
% | Package: Package
% | 
%\RCSdef{\RCSRegulartriangulationtraitsRev}{$Id$}
%\RCSdefDate{\RCSRegulartriangulationtraitsDate}{$Date$}
% |
%%RefPage: end of header, begin of main body
% +------------------------------------------------------------------------+

\begin{ccRefClass}{Apollonius_graph_hierarchy_2<Gt,Agds>}
%% add template arg's if necessary

%% \ccHtmlCrossLink{}     %% add further rules for cross referencing links
%% \ccHtmlIndexC[class]{} %% add further index entries
\ccDefinition

We provide an alternative to the class
\ccc{Apollonius_graph_2<Gt,Agds>} for the dynamic
construction of the Apollonius graph. The \ccRefName\ class maintains
a hierarchy of Apollonius graphs. The bottom-most level of the
hierarchy contains the full Apollonius diagram. A site that
is in level $i$, is in level $i+1$ with probability $1/\alpha$
where $\alpha > 1$ is some constant. The difference between the
\ccc{Apollonius_graph_2<Gt,Agds>} class and the
\ccRefName\ is on how the nearest neighbor location is done. Given a
point $p$ the location is done as follows: at the top most level we
find the nearest neighbor of $p$ as in the
\ccc{Apollonius_graph_2<Gt,Agds>} class. At every subsequent level $i$
we use the nearest neighbor found at level $i+1$ to find the nearest
neighbor at level $i$. This is a variant of the corresponding
hierarchy for points found in \cite{d-iirdt-98}.
%
The class has two template parameters which have essentially the same
meaning as in the \ccc{Apollonius_graph_2<Gt,Agds>} class. The first
template parameter must be a model of the
\ccc{ApolloniusGraphTraits_2} concept.
The second template parameter must be a model of the
\ccc{ApolloniusGraphDataStructure_2} concept. However, the vertex base
class that is to be used in the Apollonius graph data structure must
be a model of the \ccc{ApolloniusGraphHierarchyVertexBase_2} concept.
The second template parameter defaults to
\ccc{Triangulation_data_structure_2<
Apollonius_graph_hierarchy_vertex_base_2< 
Apollonius_graph_vertex_base_2<Gt,true> >,
Triangulation_face_base_2<Gt> >}. 

The \ccRefName\ class derives publicly from the
\ccc{Apollonius_graph_2<Gt,Agds>} class. The interface is
the same with its base class. In the sequel only the methods
overridden are documented.


\ccInclude{CGAL/Apollonius_graph_hierarchy_2.h}



\ccInheritsFrom
\ccc{CGAL::Apollonius_graph_2<Gt,Agds>}


\ccTypes
\ccRefName\ does not introduce other types than those introduced by
its base class \ccc{Apollonius_graph_2<Gt,Agds>}.

\ccCreation
\ccCreationVariable{agh}
%
\ccThree{Apollonius_graph_hierarchy_2<Gt,Agds>}
{agh(Gt gt=Gt());}{}
\ccThreeToTwo
%
\ccConstructor{Apollonius_graph_hierarchy_2(Gt
gt=Gt())}{Creates an hierarchy of Apollonius graphs using \ccc{gt} as
geometric traits.}
\ccGlue
\ccConstructor{template< class Input_iterator >
Apollonius_graph_hierarchy_2<Gt,Agds>(Input_iterator
first, Input_iterator beyond, Gt gt=Gt())}
{Creates an Apollonius graph hierarchy using 
\ccc{gt} as geometric traits and inserts all sites in the
range [\ccc{first}, \ccc{beyond}).}
\ccGlue
\ccConstructor{Apollonius_graph_hierarchy_2<Gt,Agds>
(Apollonius_graph_hierarchy_2<Gt,Agds> other)}
{Copy constructor. All faces, vertices and inter-level pointers
are duplicated. After the construction, \ccVar\ and \ccc{other} refer
to two different Apollonius graph hierarchies: if 
\ccc{other} is modified, \ccVar\ is not.}
\ccGlue
\ccMethod{Apollonius_graph_hierarchy_2<Gt,Agds>
operator=(Apollonius_graph_hierarchy_2<Gt,Agds>
other);}{Assignment. All faces, vertices and inter-level pointers
are duplicated. After the construction, \ccVar\ and \ccc{other} refer
to two different Apollonius graph hierarchies: if 
\ccc{other} is modified, \ccVar\ is not.} 



\ccHeading{Insertion}
\ccThree{Vertex_handle }{agh.insert(Site_2 s)+}{}
%
\ccMethod{template< class Input_iterator >
unsigned int insert(Input_iterator first, Input_iterator beyond);}
{Inserts the sites in the range
[\ccc{first},\ccc{beyond}). The number of sites in the range
  [\ccc{first}, \ccc{beyond}) is returned.
% MK:: Implement this method with copying and sorting
\ccPrecond{\ccc{Input_iterator} must be a model of \ccc{InputIterator}
  and its value type must be \ccc{Site_2}.}}
%
\ccGlue
\ccMethod{Vertex_handle  insert(Site_2 s);}{Inserts the
site \ccc{s} in the Apollonius graph hierarchy. If \ccc{s}
is visible then the vertex handle of \ccc{s} is returned, otherwise 
\ccc{Vertex_handle(NULL)} is returned.}
%
\ccGlue
\ccMethod{Vertex_handle insert(Site_2 s, Vertex_handle
vnear);}{Inserts \ccc{s} in the Apollonius graph hierarchy using the
site associated with \ccc{vnear} as
an estimate for the nearest neighbor of the center of \ccc{s}.
If \ccc{s} is visible then the vertex handle of \ccc{s} is
returned, otherwise \ccc{Vertex_handle(NULL)} is returned.
A call to this method is equivalent to \ccc{agh.insert(s);} and it has
been added for the sake of conformity with the interface of the
\ccc{Apollonius_graph_2<Gt,Agds>} class.}

\ccHeading{Removal}
\ccThree{void }{agh.remove(Vertex_handle v)+}{}
%
\ccMethod{void  remove(Vertex_handle v);}{Removes the site
associated to the vertex handle \ccc{v} from the Apollonius
graph hierarchy.
\ccPrecond{\ccc{v} must correspond to a valid finite
vertex of the Apollonius graph hierarchy.}}


\ccHeading{Nearest neighbor location}
\ccThree{Vertex_handle }{agh.nearest_neighbor(Point p)+}{}
%
\ccMethod{Vertex_handle  nearest_neighbor(Point p);}
{Finds the nearest neighbor of the point \ccc{p}. In other words it
finds the site whose Apollonius cell contains \ccc{p}. Ties are broken
arbitrarily and one of the nearest neighbors of \ccc{p} is
returned. If there are no visible sites in the Apollonius diagram
\ccc{Vertex_handle(NULL)} is returned.}
\ccGlue
\ccMethod{Vertex_handle  nearest_neighbor(Point p,
Vertex_handle vnear);}{Finds the nearest neighbor of the point
\ccc{p}. If there are no visible sites in the Apollonius diagram
\ccc{Vertex_handle(NULL)} is returned.
A call to this method is equivalent to 
\ccc{agh.nearest_neighbor(p);} and it has been added for the sake of
conformity with the interface of the
\ccc{Apollonius_graph_2<Gt,Agds>} class.}


\ccHeading{I/O}
\ccThree{std::ostream&}{agh.file_output(std::ostream& os)+}{}
\ccThreeToTwo
%
\ccMethod{void file_output(std::ostream& os);}{Writes the current
  state of the Apollonius graph hierarchy to an output stream. In particular,
  all visible and hidden sites are written as well as the
  underlying combinatorial hierarchical data structure.}
\ccGlue
\ccMethod{void file_input(std::istream& is);}{Reads the state of the
  Apollonius graph hierarchy from an input stream.}
%
\ccGlue
\ccFunction{std::ostream& operator<<(std::ostream& os,
  Apollonius_graph_hierarchy_2<Gt,Agds> agh);}
{Writes the current state of the Apollonius graph hierarchy to an
  output stream.}
\ccGlue
\ccFunction{std::istream& operator>>(std::istream& is,
  Apollonius_graph_hierarchy_2<Gt,Agds> agh);}
{Reads the state of the Apollonius graph hierarchy from an input stream.}


\ccHeading{Validity check}
\ccMethod{bool is_valid(bool verbose = false, int level = 1) const;}
{Checks the validity of the Apollonius graph hierarchy. If
\ccc{verbose} is \ccc{true} a short message is sent to
\ccc{std::cerr}. If \ccc{level} is 0, the data structure at all levels 
is validated, as well as the inter-level pointers. If \ccc{level} is
1, then the data structure at all levels is validated, the inter-level
pointers are validated and all levels of the Apollonius graph
hierarchy are also validated. Negative values of \ccc{level} always
return \ccc{true}, and values greater then 1 are equivalent to
\ccc{level} being 1.}

\ccHeading{Miscellaneous}
\ccThree{void}{agh.swap(other)+}{}
%
\ccMethod{void clear();}{Clears all contents of the Apollonius graph
hierarchy.}
\ccGlue
% MK:: add this method make copy(...) protected and see doc of TDS
\ccMethod{void swap(Apollonius_graph_hierarchy_2<Gt,Agds>
other);}
{The Apollonius graph hierarchies \ccc{other} and \ccVar\ are
swapped. \ccVar.\ccc{swap(other)} should be preferred to \ccVar\ccc{ =
other} or to \ccVar\ccc{(other)} if \ccc{other} is deleted afterwards.}


\ccSeeAlso
\ccc{ApolloniusGraphDataStructure_2}\\
\ccc{ApolloniusGraphTraits_2}\\
\ccc{ApolloniusGraphHierarchyVertexBase_2}\\
\ccc{CGAL::Apollonius_graph_2<Gt,Agds>}\\
\ccc{CGAL::Triangulation_data_structure_2<Vb,Fb>}\\
\ccc{CGAL::Apollonius_graph_traits_2<K,Method_tag>}\\
\ccc{CGAL::Apollonius_graph_filtered_traits_2<CK,CM,EK,EM,FK,FM>}\\
\ccc{CGAL::Apollonius_graph_hierarchy_vertex_base_2<Agvb>}



\end{ccRefClass}

% +------------------------------------------------------------------------+
%%RefPage: end of main body, begin of footer
% EOF
% +------------------------------------------------------------------------+
